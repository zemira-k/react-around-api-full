(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{27:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(17),i=n.n(o),s=n(8),r=(n(27),n(22)),l=n(2),u=n(3),m=n(16),p=n(0);var d=function(e){var t=Object.assign({},e);return Object(p.jsx)(u.b,Object(m.a)(Object(m.a)({},t),{},{children:function(){return t.loggedIn?t.children:Object(p.jsx)(u.a,{to:"./signin"})}}))},_=c.a.createContext(),j=n(20),b=n(21),f=new(function(){function e(t){var n=t.baseUrl;Object(j.a)(this,e),this.costumFetch=function(e,t){return fetch(e,t).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)}))},this._url=n}return Object(b.a)(e,[{key:"getInitialCards",value:function(e){return this.costumFetch("".concat(this._url,"/cards"),{headers:{"content-type":"application/json",authorization:"Bearer ".concat(e)}})}},{key:"getUserInfo",value:function(e){return this.costumFetch("".concat(this._url,"/users/me"),{headers:{"content-type":"application/json",authorization:"Bearer ".concat(e)}})}},{key:"changeLikeCardStatus",value:function(e,t,n){return this.costumFetch("".concat(this._url,"/cards/").concat(e,"/likes"),{headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},method:"".concat(t?"PUT":"DELETE")})}},{key:"deleteCard",value:function(e,t){return this.costumFetch("".concat(this._url,"/cards/").concat(e),{headers:{"content-type":"application/json",authorization:"Bearer ".concat(t)},method:"DELETE"})}},{key:"setUserInfo",value:function(e,t){return this.costumFetch("".concat(this._url,"/users/me"),{headers:{"content-type":"application/json",authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({name:e.name,about:e.about})})}},{key:"setUserAvatar",value:function(e,t){return this.costumFetch("".concat(this._url,"/users/me/avatar"),{headers:{"content-type":"application/json",authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({avatar:e})})}},{key:"addCard",value:function(e,t){return this.costumFetch("".concat(this._url,"/cards"),{headers:{"content-type":"application/json",authorization:"Bearer ".concat(t)},method:"POST",body:JSON.stringify(e)})}}]),e}())({baseUrl:"https://api.zemira.students.nomoreparties.site"}),h="https://api.zemira.students.nomoreparties.site",O={Accept:"application/json","Content-Type":"application/json"};function g(e){return e.ok?e.json():Promise.reject("".concat(e.status,": ").concat(e.statusText))}var x=function(e){var t=e.link,n=e.text,a=e.onSignOut,c=e.loggedin,o=e.email;return Object(p.jsxs)("header",{className:"header",children:[Object(p.jsx)("div",{className:"header__logo"}),Object(p.jsxs)("div",{className:"header__nav",children:[c&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("p",{className:"header__email",children:o}),Object(p.jsx)(s.b,{to:t,onClick:a,className:"header__link",children:"sign out"})]}),!c&&Object(p.jsx)(s.b,{to:t,className:"header__link",children:n})]})]})};var v=function(){return Object(p.jsx)("footer",{className:"footer",children:Object(p.jsx)("p",{className:"footer__copyrights",children:"\xa9 2021 Around The U.S."})})};var N=function(e){var t=c.a.useContext(_),n=e.card.owner===t._id,a=e.card.likes.includes(t._id),o="element__btn element__btn_type_trash ".concat(n?"element__btn_type_trash-visible":"element__btn_type_trash-hidden"),i="".concat(a?"element__name-heart element__name-heart_type_black":"element__name-heart");return Object(p.jsxs)("article",{className:"element",children:[Object(p.jsx)("button",{onClick:function(){e.onCardClick(e.card)},className:"element__btn element__btn_type_image",type:"button",children:Object(p.jsx)("img",{className:"element__item",src:e.card.link,alt:e.card.name})}),Object(p.jsx)("button",{onClick:function(){e.onCardDelete(e.card)},className:o,type:"button"}),Object(p.jsxs)("div",{className:"element__name",children:[Object(p.jsx)("h2",{className:"element__name-text",children:e.card.name}),Object(p.jsxs)("div",{className:"element__name-like",children:[Object(p.jsx)("button",{onClick:function(){e.onCardLike(e.card)},className:i,type:"button"}),Object(p.jsx)("span",{className:"element__name-number",children:e.card.likes.length})]})]})]})};var k=function(e){var t=c.a.useContext(_);return Object(p.jsxs)("main",{className:"main",children:[Object(p.jsxs)("section",{className:"profile",children:[Object(p.jsx)("div",{className:"profile__avatar",style:{backgroundImage:"url(".concat(t.avatar,")")},children:Object(p.jsx)("button",{onClick:e.onEditAvatarClick,"aria-label":"profile__editbutton",className:"profile__editbutton profile__editbutton_type_avatar",type:"button"})}),Object(p.jsxs)("div",{className:"profile__info",children:[Object(p.jsxs)("div",{className:"profile__caption",children:[Object(p.jsx)("h1",{className:"profile__name",id:"name",children:t.name}),Object(p.jsx)("button",{onClick:e.onEditProfileClick,"aria-label":"profile__editbutton",className:"profile__editbutton profile__editbutton_type_data",type:"button",id:"btnOpen"})]}),Object(p.jsx)("p",{className:"profile__task",id:"task",children:t.about})]}),Object(p.jsx)("button",{onClick:e.onAddPlaceClick,"aria-label":"add-pic",className:"profile__big-rectangle",type:"button"})]}),Object(p.jsx)("section",{className:"elements",children:e.cards.map((function(t){return Object(p.jsx)(N,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})};var y=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)(""),r=Object(l.a)(i,2),u=r[0],m=r[1];return Object(p.jsxs)("div",{className:"black-form",children:[Object(p.jsx)("p",{className:"form__header black-form__header",children:"Sign in"}),Object(p.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.onLogin({email:c,password:u})},className:"form form_type_black",children:[Object(p.jsx)("input",{className:"form__input form__input_type_black",id:"email",name:"email",type:"email",placeholder:"Email",value:c,onChange:function(e){return o(e.target.value)}}),Object(p.jsx)("input",{className:"form__input form__input_type_black",id:"password",name:"password",type:"password",placeholder:"Password",value:u,onChange:function(e){return m(e.target.value)}}),Object(p.jsx)("button",{type:"submit",className:"form__button form__button_container",children:Object(p.jsx)("p",{type:"submit",className:"form__link",children:"Sign in"})})]}),Object(p.jsxs)("div",{className:"form__signin",children:[Object(p.jsx)("p",{className:"form__signin-text",children:"Not a member yet? "}),Object(p.jsx)(s.b,{to:"signup",className:"form__signin-link",children:"Sign up here!"})]})]})};var C=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)(""),r=Object(l.a)(i,2),u=r[0],m=r[1];return Object(p.jsxs)("div",{className:"black-form",children:[Object(p.jsx)("p",{className:"form__header black-form__header",children:"Sign up"}),Object(p.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.onRegister({email:c,password:u})},className:"form form_type_black",children:[Object(p.jsx)("input",{className:"form__input form__input_type_black",id:"email",name:"email",type:"email",placeholder:"Email",value:c,onChange:function(e){return o(e.target.value)}}),Object(p.jsx)("input",{className:"form__input form__input_type_black",id:"password",name:"password",type:"password",placeholder:"Password",value:u,onChange:function(e){return m(e.target.value)}}),Object(p.jsx)("button",{type:"submit",className:"form__button form__button_container",children:Object(p.jsx)("p",{className:"form__link",children:"Sign up"})})]}),Object(p.jsxs)("div",{className:"form__signin",children:[Object(p.jsx)("p",{className:"form__signin-text",children:"Already a member?"}),Object(p.jsx)(s.b,{to:"signin",className:"form__signin-link",children:"Log in here!"})]})]})};var S=function(e){return Object(p.jsx)("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen?"popup_opened":""),children:Object(p.jsxs)("div",{className:"popup__form",children:[Object(p.jsx)("button",{onClick:e.onClose,"aria-label":"popup__close",className:"popup__close popup__close_type_".concat(e.name),type:"button",id:"btnClose"}),Object(p.jsxs)("form",{onSubmit:e.onSubmit,className:"form form_type_".concat(e.name),name:e.name,children:[Object(p.jsx)("h2",{className:"form__header",children:e.header}),Object(p.jsxs)("fieldset",{className:"form__set",children:[e.children,Object(p.jsx)("button",{"aria-label":"submit",className:"form__button form__button_type_".concat(e.name),type:"submit",value:e.buttonTitle,children:e.buttonTitle})]})]})]})})};var w=function(e){var t=c.a.useContext(_),n=c.a.useState(""),a=Object(l.a)(n,2),o=a[0],i=a[1],s=c.a.useState(""),r=Object(l.a)(s,2),u=r[0],m=r[1];return c.a.useEffect((function(){i(t.name),m(t.about)}),[t,e.isOpen]),Object(p.jsx)("div",{children:Object(p.jsxs)(S,{header:"Edit profile",name:"edit",buttonTitle:"save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:u})},children:[Object(p.jsx)("input",{onChange:function(e){i(e.target.value)},className:"form__input form__input_type_name",type:"text",name:"formName",id:"formName",minLength:"2",maxLength:"40",required:!0,pattern:".*\\S.*",value:o||""}),Object(p.jsx)("span",{className:"form__input-error form__input-error_type_name form__input-error_active",id:"formName-error"}),Object(p.jsx)("input",{onChange:function(e){m(e.target.value)},className:"form__input form__input_type_about",type:"text",name:"formAbout",id:"formAbout",minLength:"2",maxLength:"200",required:!0,pattern:".*\\S.*",value:u||""}),Object(p.jsx)("span",{className:"form__input-error form__input-error_type_about form__input-error_active",id:"formAbout-error"})]})})};var L=function(e){var t=c.a.useRef();return Object(p.jsxs)(S,{name:"edit-avatar",header:"Change profile picture",buttonTitle:"save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(p.jsx)("input",{ref:t,className:"form__input form__input_type_link",type:"url",name:"avatarImageLink",id:"avatarImageLink",required:!0}),Object(p.jsx)("span",{className:"form__input-error form__input-error_type_link form__input-error_active",id:"avatarImageLink-error"})]})};var T=function(e){var t=c.a.useState(""),n=Object(l.a)(t,2),a=n[0],o=n[1],i=c.a.useState(""),s=Object(l.a)(i,2),r=s[0],u=s[1];return c.a.useEffect((function(){o(""),u("")}),[e.isOpen]),Object(p.jsxs)(S,{name:"add",header:"New place",buttonTitle:"create",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlaceSubmit({name:a,link:r}),e.onClose()},children:[Object(p.jsx)("input",{onChange:function(e){o(e.target.value)},className:"form__input form__input_type_title",type:"text",name:"formTitle",id:"formTitle",placeholder:"Title",minLength:"1",maxLength:"30",required:!0,pattern:".*\\S.*",value:a}),Object(p.jsx)("span",{className:"form__input-error form__input-error_type_title form__input-error_active",id:"formTitle-error"}),Object(p.jsx)("input",{onChange:function(e){u(e.target.value)},className:"form__input form__input_type_img-link",type:"url",name:"formLink",id:"formLink",placeholder:"Image link",required:!0,value:r}),Object(p.jsx)("span",{className:"form__input-error form__input-error_type_img-link form__input-error_active",id:"formLink-error"})]})};var E=function(e){return Object(p.jsx)("div",{className:"popup popup_type_image ".concat(e.card.name?"popup_opened":""),children:Object(p.jsxs)("div",{className:"popup__container",children:[Object(p.jsx)("button",{onClick:e.onClose,className:"popup__close popup__close_type_image",type:"button"}),Object(p.jsxs)("figure",{className:"popup__figure",children:[Object(p.jsx)("img",{className:"popup__image",src:e.card.link,alt:e.card.name}),Object(p.jsx)("figcaption",{className:"popup__caption",children:e.card.name})]})]})})},A=n.p+"static/media/Union.a9eb6caf.svg",P=n.p+"static/media/UnionX.d4ce2a26.svg";var I=function(e){return Object(p.jsx)("div",{className:"popup popup_type_info ".concat(e.isOpen?"popup_opened":""),children:Object(p.jsxs)("div",{className:"popup__form",children:[Object(p.jsx)("button",{onClick:e.onClose,"aria-label":"popup__close",className:"popup__close",type:"button",id:"btnClose"}),Object(p.jsxs)("div",{className:"info",name:e.name,children:[Object(p.jsx)("img",{className:"info__image",src:"".concat(e.isSuccessful?A:P),alt:"".concat(e.isSuccessful?"success":"fail")}),Object(p.jsx)("p",{className:"info__text",children:"".concat(e.isSuccessful?"Success! You have now been registered.":"Oops, something went wrong! Please try again.")})]})]})})};var U=function(){var e=Object(u.g)(),t=Object(a.useState)(!1),n=Object(l.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)(""),m=Object(l.a)(s,2),j=m[0],b=m[1],N=Object(a.useState)({isOpen:!1,isSuccessful:!1}),S=Object(l.a)(N,2),A=S[0],P=S[1],U=Object(a.useState)(localStorage.getItem("jwt")),F=Object(l.a)(U,2),D=F[0],z=F[1],B=Object(a.useState)({}),J=Object(l.a)(B,2),q=J[0],R=J[1],H=Object(a.useState)([]),G=Object(l.a)(H,2),M=G[0],X=G[1],Y=Object(a.useState)(!1),K=Object(l.a)(Y,2),Q=K[0],V=K[1],W=Object(a.useState)(!1),Z=Object(l.a)(W,2),$=Z[0],ee=Z[1],te=Object(a.useState)(!1),ne=Object(l.a)(te,2),ae=ne[0],ce=ne[1],oe=Object(a.useState)({}),ie=Object(l.a)(oe,2),se=ie[0],re=ie[1];c.a.useEffect((function(){D?function(e){return fetch("".concat(h,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return g(e)}))}(D).then((function(t){b(t.data.email),i(!0),e.push("/")})).catch((function(e){return console.log(e)})):i(!1)}),[D,e]),c.a.useEffect((function(){D&&f.getUserInfo(D).then((function(e){R(e.data),f.getInitialCards(D).then((function(e){X(e)})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))}),[D]);var le=function(){P({isOpen:!0,isSuccessful:!0})},ue=function(){P({isOpen:!0,isSuccessful:!1})};function me(){V(!1),ee(!1),ce(!1),re({}),P({isOpen:!1,isSuccessful:!1})}return c.a.useEffect((function(){var e=function(e){"Escape"===e.key&&me()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),Object(p.jsx)("div",{className:"page__container",children:Object(p.jsxs)(_.Provider,{value:q,children:[Object(p.jsxs)(u.d,{children:[Object(p.jsxs)(u.b,{path:"/signin",children:[Object(p.jsx)(x,{link:"/signup",text:"sign up"}),Object(p.jsx)(y,{onLogin:function(t){var n=t.email,a=t.password;b(n),n&&a?(console.log("success"),function(e,t){return fetch("".concat(h,"/signin"),{method:"POST",headers:O,body:JSON.stringify({password:e,email:t})}).then((function(e){return g(e)})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e}))}(a,n).then((function(t){t.token&&(z(t.token),i(!0),e.push("/"))})).catch((function(e){return console.log(e)}))):console.log("fail")}})]}),Object(p.jsxs)(u.b,{path:"/signup",children:[Object(p.jsx)(x,{link:"/signin",text:"Log in"}),Object(p.jsx)(C,{onRegister:function(t){var n=t.email;(function(e,t){return fetch("".concat(h,"/signup"),{method:"POST",headers:O,body:JSON.stringify({password:e,email:t})}).then((function(e){return g(e)}))})(t.password,n).then((function(t){t&&(le(),e.push("/signin"),console.log("Register success"))})).catch((function(e){ue(),console.log("Something went wrong.")}))}})]}),Object(p.jsxs)(d,{exact:!0,path:"/",loggedIn:o,children:[Object(p.jsx)(x,{link:"/signin",text:"Log in",loggedin:o,email:j,onSignOut:function(){console.log("logged out"),i(!1),localStorage.removeItem("jwt"),e.push("/")}}),Object(p.jsx)(k,{onEditProfileClick:function(){V(!0)},onAddPlaceClick:function(){ee(!0)},onEditAvatarClick:function(){ce(!0)},onCardClick:function(e){re(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e===q._id}));f.changeLikeCardStatus(e._id,!t,D).then((function(t){var n=t.data;X((function(t){return t.map((function(t){return t._id===e._id?n:t}))}))})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){f.deleteCard(e._id,D).then((function(t){X((function(t){return t.filter((function(t){return t._id!==e._id}))}))})).catch((function(e){return console.log(e)}))},cards:M})]})]}),Object(p.jsx)(T,{isOpen:$,onClose:me,onAddPlaceSubmit:function(e){f.addCard(e,D).then((function(e){X([].concat(Object(r.a)(M),[e.data]))})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(w,{isOpen:Q,onClose:me,onUpdateUser:function(e){f.setUserInfo(e,D).then((function(e){R(e.data),me()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(L,{isOpen:ae,onClose:me,onUpdateAvatar:function(e){f.setUserAvatar(e.avatar,D).then((function(e){R(e.data),me()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(E,{card:se,onClose:me}),Object(p.jsx)(I,{isOpen:A.isOpen,isSuccessful:A.isSuccessful,onClose:me}),Object(p.jsx)(v,{})]})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),o(e),i(e)}))};i.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(s.a,{children:Object(p.jsx)(U,{})})}),document.getElementById("root")),F()}},[[37,1,2]]]);
//# sourceMappingURL=main.ed9d2c22.chunk.js.map